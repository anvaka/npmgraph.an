const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/renderer3d-W-qh5uRi.js","assets/index-wXhy9pUh.js","assets/PackageInfo-DTkeywRC.js","assets/index-BveyBTtd.js","assets/index-BwHuJX8E.css"])))=>i.map(i=>d[i]);
import{o as C,u as _,i as F,m as x,_ as G,a as j,b as s,c as r,f as l,d as V,e as v,t as u,F as E,g as H,h as J,T as A,j as O,k as U,s as I,r as i,l as $}from"./index-BveyBTtd.js";import{b as q,a as z,s as K,_ as Q,c as W}from"./PackageInfo-DTkeywRC.js";const X={class:"full"},Y={key:1,class:"graph-errors"},Z={key:0,class:"error-version"},ee={class:"error-message"},ae={key:2,class:"graph-progress"},oe={key:3,class:"graph-progress"},ne={key:0,class:"switchMode d2d"},re={__name:"Package3dView",setup(te){const p=O(),w=U(),m=i(null),g=I(null),k=i(!1),R=i(!0),b=i(0),d=$([]),c=i(null),L=I(null),h=i(!1),f=i(""),y=i(!0);let a=null;C(()=>{var e;if(p.params.pkgId==="~upload"){if(!_.value){w.replace("/");return}var o=_.value;e=q(o,{includeDevDeps:F.value},N)}else e=z(p.params.pkgId,p.params.version,N);var t=x(e.graph);g.value=t,G(()=>import("./renderer3d-W-qh5uRi.js"),__vite__mapDeps([0,1,2,3,4])).then(function(n){if(m.value){var B=n.default;a=B(t,m.value),a.onNodeSelected(function(T){c.value&&c.value.onNodeSelected(T)}),a.run(),e.start().then(function(){P(e.errors)})}})}),j(()=>{a&&(a.dispose(),a=null)});function N(e){b.value=e}function P(e){k.value=!0,R.value=!1,e&&e.length&&d.push.apply(d,e);var o=g.value,t=p.params.pkgId==="~upload"?(_.value.name||"uploaded-project")+"@"+(_.value.version||"0.0.0"):null;o.root||(t&&(o.root=o.getNode(t)),o.root||o.forEachNode(function(n){o.root||(o.root=n)})),c.value&&c.value.onGraphLoaded(o),h.value=!0,K(g.value,{onProgress:function(n){f.value=n}}).then(function(n){L.value=n,h.value=!1,a&&a.applyVulnStates(n),c.value&&c.value.onVulnDataLoaded(n)}).catch(function(){h.value=!1,f.value=""})}function M(e){a&&a.highlightNodes(e)}function S(){a&&(a.toggleLayout(),y.value=a.layoutRunning)}function D(){var e=W(p.params,!0);w.push(e)}return(e,o)=>(s(),r("div",X,[l("div",{ref_key:"container",ref:m,class:"graphView"},null,512),(s(),V(A,{to:"#sidebar-target"},[g.value?(s(),V(Q,{key:0,ref_key:"packageInfoRef",ref:c,graph:g.value,"show-actions":k.value,"layout-running":y.value,"vuln-map":L.value,onHighlightNode:M,onToggleLayout:S,onSwitchMode:D},null,8,["graph","show-actions","layout-running","vuln-map"])):v("",!0),d.length?(s(),r("div",Y,[l("h4",null,"Failed to resolve "+u(d.length)+" package"+u(d.length>1?"s":"")+":",1),l("ul",null,[(s(!0),r(E,null,H(d,(t,n)=>(s(),r("li",{key:n},[l("strong",null,u(t.name),1),t.version?(s(),r("span",Z,u(t.version),1)):v("",!0),l("div",ee,u(t.message),1)]))),128))])])):v("",!0),R.value?(s(),r("div",ae,[l("h4",null,[o[0]||(o[0]=J("Remaining packages: ",-1)),l("span",null,u(b.value),1)])])):v("",!0),h.value&&f.value?(s(),r("div",oe,[l("h4",null,u(f.value),1)])):v("",!0)])),k.value?(s(),r("div",ne,[l("button",{class:"btn",type:"button",onClick:S},u(y.value?"Stop":"Start")+" layout ",1),l("button",{class:"btn",type:"button",onClick:D},"Show 2D")])):v("",!0)]))}};export{re as default};
